name: deploy to a server back-end

on:
  # push:
  #   branches: [ main ]

  workflow_dispatch 

jobs:
  build:
    name: Build
    runs-on: ubuntu-latest
    steps:

      - name: Get latest code
        uses: actions/checkout@v2

      # - name: Use Node.js 14
      #   uses: actions/setup-node@v2
      #   with:
      #     node-version: '14.17.6'

      - name: Build Project
        run: |
          npm install
          npm run build
  # deploy: 
  #   name: Deploy ðŸš€
  #   needs: build
  #   runs-on: ubuntu-latest
  #   steps: 
  #     - name: Checkout repository
  #       uses: actions/checkout@main
  #     - name: Download artifact
  #       uses: actions/download-artifact@main
  #       with: 
  #         name: build
  #         path: build
      - name: FTP Deploy
        uses: SamKirkland/FTP-Deploy-Action@4.3.2
        with:
          server: ${{ secrets.FTP_HOST }}
          username: ${{ secrets.FTP_USER }}
          password: ${{ secrets.FTP_PASSWORD }}
          server-dir: .tmp/
          include: | 
            **build/media/*/**
            index.html
          exclude: |
            **/.git*
            **/.git*/**
            **/node_modules/**
            **/public/**
            **/.github/worflows
            **/src/**

      - name: Build Project frontend go to back
        run: |
          echo "Deploy frontend"
          sleep 10s